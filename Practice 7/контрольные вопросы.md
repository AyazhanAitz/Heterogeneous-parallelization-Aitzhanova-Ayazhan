## 1. В чём разница между редукцией и сканированием?

**Редукция** — это операция агрегирования массива в **одно итоговое значение**
(например, сумма, максимум, минимум).

**Сканирование (префиксная сумма)** — это операция, при которой формируется **новый массив**,
где каждый элемент равен сумме всех предыдущих элементов входного массива.

**Ключевое различие:**

* редукция → *один результат*
* сканирование → *массив результатов*

## 2. Какие типы памяти CUDA используются для оптимизации редукции и сканирования?

Для оптимизации редукции и сканирования используются следующие типы памяти CUDA:

1. **Глобальная память**

   * используется для хранения входных и выходных данных;
   * имеет высокую задержку, поэтому её использование стараются минимизировать.

2. **Разделяемая память (Shared Memory)**

   * используется для хранения промежуточных результатов внутри блока;
   * значительно быстрее глобальной памяти;
   * является ключевым элементом оптимизации редукции и scan.

3. **Регистры**

   * применяются для хранения локальных переменных потоков;
   * обеспечивают максимальную скорость доступа.

4. **Pinned Host Memory**

   * используется для ускорения передачи данных между CPU и GPU;
   * снижает накладные расходы при `cudaMemcpy`.

## 3. Как можно оптимизировать префиксную сумму на GPU?

Основные способы оптимизации префиксной суммы на GPU:

1. Использование **shared memory** для выполнения scan внутри блока.
2. Применение **иерархического (multi-block) алгоритма**:

   * scan внутри блоков;
   * scan массива сумм блоков;
   * добавление оффсетов к каждому блоку.
3. Минимизация обращений к **глобальной памяти**.
4. Выбор оптимального **размера блока потоков** (обычно 128–256).
5. Использование эффективных алгоритмов scan
   (например, **Blelloch scan** вместо простых схем).
6. Использование **coalesced memory access** для повышения пропускной способности памяти.

## 4. Приведите пример задачи, где применяется сканирование.

Префиксная сумма применяется, например, в **компактации массива**:

* имеется массив флагов (0/1), где `1` означает «элемент нужно сохранить»;
* выполняется scan по массиву флагов;
* результаты scan используются для определения новых позиций элементов в выходном массиве.

Также сканирование применяется в:

* параллельной сортировке (radix sort);
* построении гистограмм;
* графовых алгоритмах;
* вычислении CSR-представления разреженных матриц.

Если хочешь, я могу:

* сократить ответы **до 1–2 предложений**
* переписать **строго в экзаменационном стиле**
* оформить **прямо для вставки в отчёт (без маркеров)**
